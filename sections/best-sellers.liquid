{% comment %}
  Section: Best Sellers (BEM classes)
{% endcomment %}
<section class="bestsellers">
  <div class="bestsellers__container">
    {% if section.settings.eyebrow != blank %}
      <div class="bestsellers__eyebrow">{{ section.settings.eyebrow }}</div>
    {% endif %}
    {% if section.settings.heading != blank %}
      <h2 class="bestsellers__title">{{ section.settings.heading }}</h2>
    {% endif %}

    <div class="bestsellers__scroller">
      <div class="bestsellers__list owl-carousel" id="bestsellers-{{ section.id }}">
        {% if section.settings.source == 'collection' and section.settings.collection != blank %}
          {% for product in section.settings.collection.products limit: section.settings.product_limit %}
            {% render 'product-card', product: product %}
          {% endfor %}
        {% else %}
          {% for block in section.blocks %}
            {% assign product = block.settings.product %}
            {% if product %}
              {% render 'product-card', product: product, block: block %}
            {% endif %}
          {% endfor %}
        {% endif %}
      </div>

      <div class="bestsellers__nav">
        <button class="bestsellers__btn bestsellers__btn--prev" type="button" aria-label="Previous">‹</button>
        <button class="bestsellers__btn bestsellers__btn--next" type="button" aria-label="Next">›</button>
      </div>
    </div>
  </div>

  {% stylesheet %}
    .bestsellers {
      padding: 48px 0;
      background: #f7f7f7;
    }
    .bestsellers__container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 16px;
    }
    .bestsellers__eyebrow {
      display: inline-block;
      font-size: 12px;
      font-weight: 600;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      background: #ffe79a;
      padding: 8px 12px;
      border-radius: 999px;
    }
    .bestsellers__title {
      margin: 12px 0 24px;
      font-size: clamp(20px, 4vw, 28px);
      font-weight: 800;
    }
    .bestsellers__scroller {
      position: relative;
    }

    .bestsellers__item {
      scroll-snap-align: start;
    }
    .product-card {
      display: block;
      background: #fff;
      border-radius: 16px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
      padding: 20px;
      text-decoration: none;
      color: inherit;
      height: 100%;
    }
    .product-card__media {
      display: grid;
      place-items: center;
      height: 220px;
      background: #fff7c9;
      border-radius: 12px;
      margin-bottom: 14px;
    }
    .product-card__image {
      max-width: 100%;
      height: 100%;
      object-fit: contain;
    }
    .product-card__title {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 6px;
    }
    .product-card__price {
      font-size: 14px;
    }
    .product-card__price-current {
      font-weight: 700;
      margin-right: 6px;
    }
    .product-card__price-compare {
      color: #9b9b9b;
    }
    .bestsellers__nav {
      position: absolute;
      right: 0;
      bottom: 8px;
      display: flex;
      gap: 10px;
    }
    .bestsellers__btn {
      width: 40px;
      height: 40px;
      border-radius: 999px;
      border: 1px solid #e5e5e5;
      background: #fff;
      cursor: pointer;
      font-size: 18px;
      line-height: 1;
    }
    .bestsellers__btn:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }
    @media (hover: hover) {
      .product-card:hover {
        box-shadow: 0 6px 16px rgba(0, 0, 0, 0.1);
        transform: translateY(-1px);
        transition: 0.2s ease;
      }
    }

    /* remove scroll snapping & overflow; Owl will control it */
    .bestsellers__list {
      display: block; /* Owl transforms children into slides */
      padding: 0; /* Owl adds its own gutters; we use margin option */
    }
    /* keep your card styles as-is */
    .owl-theme .owl-nav {
      position: absolute;
      right: 0;
      top: -56px;
    }
    .owl-theme .owl-nav [class*='owl-'] {
      width: 40px;
      height: 40px;
      border-radius: 999px;
      border: 1px solid #e5e5e5;
      background: #fff;
      font-size: 18px;
      line-height: 38px;
    }
    .owl-theme .owl-nav [class*='owl-']:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }
  {% endstylesheet %}
</section>

{% schema %}
{
  "name": "Best sellers (carousel)",
  "settings": [
    { "type": "text", "id": "eyebrow", "label": "Eyebrow", "default": "Our Best Sellers" },
    { "type": "text", "id": "heading", "label": "Heading", "default": "South India’s most‑loved snacks!" },
    {
      "type": "radio",
      "id": "source",
      "label": "Product source",
      "default": "collection",
      "options": [
        { "value": "collection", "label": "From a collection" },
        { "value": "manual", "label": "Manually select products" }
      ]
    },
    { "type": "collection", "id": "collection", "label": "Collection (used when source = collection)" },
    {
      "type": "range",
      "id": "product_limit",
      "label": "Max products to show (collection mode)",
      "min": 2,
      "max": 12,
      "step": 1,
      "default": 8
    }
  ],
  "blocks": [
    {
      "type": "product",
      "name": "Product (manual)",
      "limit": 20,
      "settings": [{ "type": "product", "id": "product", "label": "Product" }]
    }
  ],
  "presets": [{ "name": "Best sellers (carousel)", "category": "Products" }]
}
{% endschema %}
